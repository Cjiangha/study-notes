@vuexçš„ç›¸å…³çŸ¥è¯†ç‚¹ä¸å¤šï¼Œä½†è¾ƒä¸ºéš¾ç†è§£ï¼Œå¾ˆå¤šæ²¡æœ‰åšè¿‡é¡¹ç›®çš„åŒå­¦å»çœ‹å®˜æ–¹æ–‡æ¡£å¯èƒ½æ— æ³•çœŸæ­£ç†è§£ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œé™¤äº†ä»‹ç»å…¶åŸºæœ¬çš„å®‰è£…ä½¿ç”¨ä¹‹å¤–ï¼Œä¼šä»ä»–çš„åº”ç”¨åœºæ™¯åŠä½¿ç”¨vuexçš„å¥½å¤„ç­‰æ–¹é¢æ¥èŠä¸€ä¸‹ä¸ªäººæµ…è§ï¼

# vuexæ˜¯ä»€ä¹ˆï¼Ÿ

> **å®˜è¯**ï¼šVuex æ˜¯ä¸€ä¸ªä¸“ä¸º Vue.js åº”ç”¨ç¨‹åºå¼€å‘çš„çŠ¶æ€ç®¡ç†æ¨¡å¼ã€‚å®ƒé‡‡ç”¨é›†ä¸­å¼å­˜å‚¨ç®¡ç†åº”ç”¨çš„æ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€ï¼Œå¹¶ä»¥ç›¸åº”çš„è§„åˆ™ä¿è¯çŠ¶æ€ä»¥ä¸€ç§å¯é¢„æµ‹çš„æ–¹å¼å‘ç”Ÿå˜åŒ–ã€‚

æˆ‘ä¸ªäººçš„ç†è§£æ˜¯ï¼Œå¦‚æœæœ‰ä¸€äº›å…¬å…±çš„æ•°æ®éœ€è¦åœ¨å¤šä¸ªç»„ä»¶ä¸­å…±äº«æˆ–è€…æŸä¸€ä¸ªçŠ¶æ€çš„æ”¹å˜ä¼šå½±å“å¤šä¸ªç»„ä»¶ï¼Œé‚£ä¹ˆè¿™æ—¶å€™ç”¨vuexæ˜¯éå¸¸åˆé€‚çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬ç»å¸¸ä¼šçœ‹åˆ°çš„ä¸­åå°éƒ½æœ‰å¤šé£æ ¼çš„åˆ‡æ¢ï¼Œè¿™ç§å…¨å±€çš„æ”¹å˜å°±å¯ä»¥ç”¨åˆ°vuexå»å®Œæˆï¼

# vuexçš„åŸºæœ¬ä½¿ç”¨

1. **å®‰è£…**

```bash
npm install --save vuex
å¤åˆ¶ä»£ç 
```

1. main.jsä¸­å¼•å…¥

```js
import store from "./store";

new Vue({
  router,
  store,   // vuex
  render: h => h(App)
}).$mount("#app");
å¤åˆ¶ä»£ç 
```

1. åœ¨æˆ‘ä»¬ç”¨vue/cliåˆ›å»ºçš„é¡¹ç›®çš„store/index.jsä¸­å¼•å…¥å¦‚ä¸‹å†…å®¹

```js
import Vue from "vue";
import Vuex from "vuex";

Vue.use(Vuex);

export default new Vuex.Store({
  state: {},
  mutations: {},
  actions: {},
  modules: {}
});
å¤åˆ¶ä»£ç 
```

# vuexçš„äº”ä¸ªæ ¸å¿ƒ

vuexä¸­æœ‰äº”ä¸ªæ ¸å¿ƒï¼Œå³ä»¥ä¸Šä»£ç ä¸­å±•ç¤ºçš„ **state**ã€**getter**ã€ **mutations**ã€**actions**ã€**modules**ï¼

## state

**state**: å®šä¹‰äº†åº”ç”¨çŠ¶æ€çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥åœ¨è¿™é‡Œè®¾ç½®é»˜è®¤çš„åˆå§‹çŠ¶æ€ã€‚

**è€è§„çŸ©ï¼Œç¿ èŠ±ä¸Šä»£ç **ï¼š

åœ¨store/index.jsä¸­çš„stateä¸­ä¼ å…¥ä¸€ä¸ªé”®å€¼å¯¹ `counter: 10`,è¿™ä¸ªé”®å€¼å¯¹å°±è®°å½•äº†ä¸€ä¸ªcounterçš„å…¬å…±çš„æ•°æ®åˆå§‹çŠ¶æ€ï¼

```js
export default new Vuex.Store({
  state: {
    counter: 10
  },
  ...
});
å¤åˆ¶ä»£ç 
```

ç»„ä»¶ä¸­é€šè¿‡ `$store.state.counter` å³å¯è°ƒç”¨åˆ°conterçš„å€¼ï¼Œä½†ä¸€èˆ¬æˆ‘ä»¬ä¼šå°†è¿™ä¸ªçŠ¶æ€æ”¾åœ¨è®¡ç®—å±æ€§å½“ä¸­ï¼

ä»¥æˆ‘ä»¬çš„é¡¹ç›®ä¸ºä¾‹ï¼Œåœ¨`src/components`çš„è·¯å¾„ä¸‹æœ‰ä¸€ä¸ª`HelloWorld.vue`çš„ç»„ä»¶ï¼Œæˆ‘ä»¬æ¥é€šè¿‡å°è£…ä¸€ä¸ª`count`çš„è®¡ç®—å±æ€§æ¥è°ƒç”¨ä¸‹`counter`çš„å€¼ï¼š

**è€è§„çŸ©ï¼Œç¿ èŠ±ä¸Šä»£ç **ï¼š

```js
<template>
  <div class="hello">
    <h1>{{ msg }}</h1>
    <p>{{ count }}:è®¡ç®—å±æ€§ </p>
  </div>
</template>

<script>
export default {
  name: "HelloWorld",
  props: {
    msg: String
  },
  computed:{
    count(){
      return this.$store.state.counter
    }
  }
};
</script>
å¤åˆ¶ä»£ç 
```

![img](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fb35a346175a4d9b9fbb43b57cb46c44~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp)

## getters

**getters**: å®é™…ä¸Šæ˜¯storeçš„è®¡ç®—å±æ€§ï¼Œç±»ä¼¼äºcomputed,å¯¹stateé‡Œçš„æ•°æ®è¿›è¡Œä¸€äº›è¿‡æ»¤ï¼Œæ”¹é€ ç­‰ç­‰,å¦‚æœstateä¸­çš„å€¼éœ€è¦é€šè¿‡æŸç§å˜æ¢,æ‰èƒ½ä¼ ç»™ç”¨æˆ·æŸ¥çœ‹ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨è¿™é‡Œå®šä¹‰æ–¹æ³•è¿›è¡Œè½¬æ¢ï¼

> å‡è®¾æˆ‘ä»¬è¦åœ¨state.counterçš„åŸºç¡€ä¸Šæ´¾ç”Ÿå‡ºä¸€ä¸ªæ–°çš„çŠ¶æ€powercountå‡ºæ¥ï¼Œè¿™ä¸ªçŠ¶æ€éœ€è¦counterç›¸ä¹˜çš„ç»“æœï¼Œ æˆ‘ä»¬å°±å¯ä»¥è¿™æ ·åšï¼

- **getters** æ¥å— **state** ä½œä¸ºå…¶ç¬¬ä¸€ä¸ªå‚æ•°ï¼š

```js
export default new Vuex.Store({
  state: {
    counter: 10
  },
  getters: {
    pownercount(state){
      return state.counter * state.counter
    }
  },
});
å¤åˆ¶ä»£ç 
```

åœ¨ç»„ä»¶ä¸­å¯ä»¥é€šè¿‡`$store.getters.pownercount`è·å–æ–°çŠ¶æ€çš„å€¼ï¼Œç»§ç»­åœ¨è®¡ç®—å±æ€§computedä¸­æ„é€ ä¸€ä¸ªpowerconteræ–¹æ³•ï¼Œåœ¨ç»„å»ºä¸­ç›´æ¥è°ƒç”¨`{{ powerconter }}`å³å¯ï¼

```html
<script>
export default {
  name: "HelloWorld",
  props: {
    msg: String
  },
  computed:{
    count(){
      return this.$store.state.counter
    },
    powerconter(){
      return this.$store.getters.pownercount
    },
  },
};
</script>
å¤åˆ¶ä»£ç 
```

![img](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b1da1cbe8de34a2d8f78cfdad4dbe27a~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp)

## mutations

**mutations**ï¼š æä¾›ä¿®æ”¹ storeä¸­çš„çŠ¶æ€çš„å…¥å£ï¼Œå¿…é¡»æ˜¯åŒæ­¥å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦æ ¹æ®æŸäº›æ¡ä»¶æ”¹å˜æŸä¸ªçŠ¶æ€ï¼Œå³å¯åœ¨è¿™é‡Œå®šä¹‰ï¼š

æˆ‘ä»¬åœ¨ **mutations** ä¸­å®šä¹‰äº†ä¸€ä¸ªå«`add`çš„å‡½æ•°ï¼Œå‡½æ•°ä½“å°±æ˜¯æˆ‘ä»¬è¦è¿›è¡Œæ›´æ”¹çš„åœ°æ–¹,ä¼šæ¥å— `state`ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯è‡ªå®šä¹‰ä¼ å‚,æˆ‘ä»¬å°†çŠ¶æ€counterçš„è‡ªå¢1ï¼š

```js
export default new Vuex.Store({
  state: {
    counter: 10
  },
  getters: {
    pownercount(state){
      return state.counter * state.counter
    }
  },
  mutations: {
    add(state){
      return state.counter += 1
    }
  },
});
å¤åˆ¶ä»£ç 
```

åœ¨ç»„ä»¶ä¸­ä½¿ç”¨å¿…é¡»å…ˆå£°æ˜ä¸€ä¸ªæ–¹æ³•ï¼Œç„¶ååœ¨methodsä¸­é€šè¿‡å£°æ˜çš„æ–¹æ³•åŠ commitå°†è¿™ä¸ªæ–¹æ³•ä¼ é€’è¿‡å»ï¼š

```html
<template>
  <div class="hello">
    <h1>{{ msg }}</h1>
    <p>{{ count }}:è®¡ç®—å±æ€§ </p>
    <!-- ç‚¹å‡»countçš„å€¼ä¼šè‡ªå¢1,è°ƒç”¨çš„ä¸¤ç§æ–¹å¼  -->
    <button @click="$store.commit('add')">add</button>
    <!-- åœ¨methodsä¸­å®šä¹‰çš„æ–¹æ³•  -->
    <button @click="addcount()">addcount</button>
  </div>
</template>

<script>
export default {
  name: "HelloWorld",
  props: {
    msg: String
  },
  computed:{
    count(){
      return this.$store.state.counter
    },
    powerconter(){
      return this.$store.getters.pownercount
    },
  },
  methods:{
    addcount(){
      this.$store.commit('add');
    }
  }
};
</script>
å¤åˆ¶ä»£ç 
```

ä¸ºäº†æ–¹ä¾¿éšå¤„è°ƒç”¨æˆ‘ä»¬ä¸€èˆ¬åœ¨methodsä¸­å®šä¹‰ä¸€ä¸ªæ–¹æ³•ä½¿ç”¨ï¼

```html
<!-- ç›´æ¥ä½¿ç”¨  -->
<button @click="$store.commit('add')">add</button>
<!-- åœ¨methodsä¸­å®šä¹‰çš„æ–¹æ³•  -->
<button @click="addcount()">addcount</button>
å¤åˆ¶ä»£ç 
```

è¿˜å¯ä»¥é€šè¿‡åœ¨ç»„ä»¶ä¸­å¼•å…¥vuexçš„mapMutationsç›´æ¥æ³¨å†Œ

```html
<script>
// å¼•å…¥mapMutations
import {mapMutations} from 'vuex'
export default {
  name: "HelloWorld",
  props: {
    msg: String
  },
  computed:{
    count(){
      return this.$store.state.counter
    },
    powerconter(){
      return this.$store.getters.pownercount
    },
  },
  methods:{
    ...mapMutations(['add'])
  }
};
</script>
å¤åˆ¶ä»£ç 
```

è°ƒç”¨ï¼š

```html
<button @click="mutationsä¸­çš„æ–¹æ³•åç§°('å¯å¸¦å‚æ•°')">-</button>
å¤åˆ¶ä»£ç 
```

## actions

**actions**ï¼šå½“éœ€è¦å¼‚æ­¥æ›´æ”¹æ•°æ®æ—¶ï¼Œé€šè¿‡ Action æäº¤çš„æ˜¯ mutationï¼Œè€Œä¸æ˜¯ç›´æ¥å˜æ›´çŠ¶æ€ã€‚

**Action ç±»ä¼¼äº mutationï¼Œä¸åŒåœ¨äºï¼š**

1. Action æäº¤çš„æ˜¯ mutationï¼Œè€Œä¸æ˜¯ç›´æ¥å˜æ›´çŠ¶æ€ã€‚
2. Action å¯ä»¥åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œã€‚

è€è§„çŸ©ï¼Œç¿ èŠ±ä¸Šä»£ç ï¼š

```js
// store/index.js

export default new Vuex.Store({
  state: {
    counter: 10,
    // æ–°å®šä¹‰ä¸€ä¸ªobj
    obj: {}
  },
  getters: {
    pownercount(state){
      return state.counter * state.counter
    }
  },
  mutations: {
    add(state){
      state.counter += 1;
    },
    // ä¿®æ”¹stateä¸­çš„obj
    getparam(state, Object){
      state.obj = Object
    }
  },
  actions: {
    getparamsync(context, Object){
      // æ¨¡æ‹Ÿå¼‚æ­¥è¯·æ±‚ï¼Œå»¶æ—¶3s
      setTimeout(()=>{
      	// é€šè¿‡commitæäº¤ä¸€ä¸ªåä¸ºgetparamçš„mutation
      	//action å‡½æ•°æ¥å—ä¸€ä¸ªä¸ store å®ä¾‹å…·æœ‰ç›¸åŒæ–¹æ³•å’Œå±æ€§çš„ context å¯¹è±¡ï¼Œå› æ­¤ä½ å¯ä»¥è°ƒç”¨ context.commit æäº¤ä¸€ä¸ª mutation
        context.commit('getparam',Object)
      },3000)
    }
  },
});
å¤åˆ¶ä»£ç 
```

åœ¨ç»„å»ºä¸­é€šè¿‡`$store.dispatch('increment')`è§¦å‘è°ƒç”¨

```js
<template>
  <div class="hello">
    <h1>{{ msg }}</h1>
    <button @click="getVal()">getobj</button>
    <p>{{ $store.state.obj }}</p>
  </div>
<template>

 methods:{
    ...
    getVal() {
    	  let name= 'xia';
    	  let age= '26';
    	  let sex= 'man';
    	  //1.é€šè¿‡dispatchå°†æ–¹æ³•getParamSyncå’Œå¤šä¸ªå‚æ•°{name,age,sex}ä¼ é€’ç»™actions
    	  this.$store.dispatch('getparamsync',{name,age,sex})
       },
    ...
  }
å¤åˆ¶ä»£ç 
```

![img](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/840dc138a5a041ecaa4cfadafceec810~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp)

## modules

ç”±äº Vuex ä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ï¼Œåº”ç”¨çš„æ‰€æœ‰çŠ¶æ€ä¼šé›†ä¸­åˆ°ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å¯¹è±¡ã€‚Vuex å…è®¸å°† store åˆ†å‰²æˆæ¨¡å—ï¼ˆ module ï¼‰ã€‚æ¯ä¸ªæ¨¡å—æ‹¥æœ‰è‡ªå·±çš„ stateã€mutationã€actionã€getter ç”šè‡³æ˜¯åµŒå¥—å­æ¨¡å—â€”â€”ä»ä¸Šè‡³ä¸‹è¿›è¡ŒåŒæ ·æ–¹å¼çš„åˆ†å‰²ã€‚

**å¦‚ä¸‹æ‰€ç¤ºï¼š**

```js
modules: {
    // å¦‚æœæœ‰å¤šä¸ªå¯ä»¥åœ¨è¿™é‡Œç‹¬ç«‹åˆ†éš”ä¸ºå¤šä¸ªæ¨¡å—
    a: {
    // Appä¸­è°ƒç”¨{{ $store.state.a }}
      state: {
        name: 'vue'
      },
    // å…¶ä½™ç»„å»ºä¸­è°ƒç”¨ä¸å¤–ä¾§è°ƒç”¨ä¸€è‡´
      mutations: {},
      actions: {},
      getters: {}
    },
    b: {

    }
  }
å¤åˆ¶ä»£ç 
```

# æ€»ç»“

æœ€åå†å»çœ‹å®˜æ–¹æä¾›çš„ Vuex çš„è®¾è®¡æµç¨‹å›¾ï¼Œå°±è±ç„¶å¼€æœ—äº†ã€‚

![img](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3c2bd8edafc0430dbca157a51d57eb81~tplv-k3u1fbpfcp-zoom-in-crop-mark:1304:0:0:0.awebp)

åœ¨ Vuex ä¸­è¯´ç™½äº†ï¼Œä»»ä½•çš„æ“ä½œéƒ½æ˜¯å›´ç»• **state** æ¥è¿›è¡Œçš„ï¼ŒVuex æ˜¯çŠ¶æ€ç®¡ç†å™¨ï¼Œä½œç”¨å°±æ˜¯ç®¡ç† **state** ä¸­çš„çŠ¶æ€ï¼Œå…¶ä»–æä¾›çš„æ‰€æœ‰åŠŸèƒ½ Getterã€Mutationã€Action éƒ½æ˜¯ä¸ºäº†èƒ½å¤Ÿæ›´å¥½çš„ç®¡ç† stateï¼Œè€Œä¹‹æ‰€ä»¥è®¾è®¡æˆæœŸæœ›é€šè¿‡ Mutation æ”¹å˜çŠ¶æ€ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬æœŸæœ›æ‰€æœ‰çŠ¶æ€çš„å˜åŒ–éƒ½æ˜¯æœ‰è¿¹å¯å¾ªçš„ï¼

> æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œå¦‚æœå¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œæ¬¢è¿å…³æ³¨"CRMEB"æ˜é‡‘å·ã€‚ç äº‘ä¸Šæœ‰æˆ‘ä»¬å¼€æºçš„[å•†åŸé¡¹ç›®](https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FZhongBangKeJi%2FCRMEB)ï¼Œ[çŸ¥è¯†ä»˜è´¹é¡¹ç›®](https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FZhongBangKeJi%2Fcrmeb_zzff_class)ï¼Œ[JAVAç‰ˆå…¨å¼€æºå•†åŸç³»ç»Ÿ](https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FZhongBangKeJi%2Fcrmeb_java)ï¼Œå­¦ä¹ ç ”ç©¶æ¬¢è¿ä½¿ç”¨ï¼Œè€é“é¡ºæ‰‹ç‚¹ä¸ªstarå‘—ï¼Œè€æ¿å¥–åŠ±äº”æ¯›ï¼Œåˆ†ä½ ä¸¤æ¯›äº”ï¼ŒğŸ˜‚ğŸ˜‚å…³æ³¨æˆ‘ä»¬ä¿æŒè”ç³»ï¼


ä½œè€…ï¼šCRMEBæŠ€æœ¯å›¢é˜Ÿ
é“¾æ¥ï¼šhttps://juejin.cn/post/6920515575055646728
æ¥æºï¼šç¨€åœŸæ˜é‡‘
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚